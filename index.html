<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Show V√©lo 2026</title>

<style>
:root{
  --bg:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --soft:#f3f4f6;
  --fill:#111827;
  --success:#16a34a;
  --radius:18px;
}
[data-theme="dark"]{
  --bg:#0f172a;
  --text:#f8fafc;
  --muted:#94a3b8;
  --border:#1e293b;
  --soft:#020617;
  --fill:#38bdf8;
}
.pill.warning{
  background:#fff7ed;
  color:#c2410c;
  border-color:#fdba74;
}

[data-theme="dark"] .pill.warning{
  background:#451a03;
  color:#fed7aa;
  border-color:#92400e;
}
  
body{
  margin:0;
  padding:18px;
  background:var(--soft);
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  color:var(--text);
}

.wrap{max-width:1100px;margin:auto;}
.tools{display:flex;gap:8px;margin-bottom:12px;}

.card{
  background:var(--bg);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:0 8px 26px rgba(0,0,0,.06);
  overflow:hidden;
  margin-bottom:16px;
}

.pad{padding:20px;}
.top{display:flex;justify-content:space-between;gap:12px;}
h1{margin:0;font-size:22px;}
h2{margin-top:0;}
h3{margin-top:20px;}

.sub{color:var(--muted);font-size:13px;}
.amount{font-weight:900;font-size:18px;}

.bar{margin-top:14px;height:14px;background:var(--soft);border-radius:999px;overflow:hidden;}
.fill{height:100%;width:0%;background:var(--fill);transition:width .8s ease;}

.row{display:flex;justify-content:space-between;margin-top:10px;font-size:12px;color:var(--muted);}
.pill{border:1px solid var(--border);padding:3px 9px;border-radius:999px;}

.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:14px;}
.box{border:1px solid var(--border);border-radius:14px;padding:12px;}

.btn{
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#fff;
  font-weight:700;
  cursor:pointer;
}
.btn.primary{background:var(--fill);color:#fff;}
.btn.success{background:var(--success);color:#fff;}

.story{
  font-size:14px;
  line-height:1.7;
  margin-top:12px;
}

/* HERO */
.hero {
  height: 500px;
  display: flex;
  align-items: flex-end;
  padding: 20px;
  color: white;
  font-size: 26px;
  font-weight: 900;
  /* On place le d√©grad√© en premier (au-dessus) et on ajuste la position */
  background: 
    linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 40%),
    url("img/POSTER.jpg") no-repeat;
  background-position: center 2px; /* On descend l'image de 2px */
  background-size: cover;
  background-color: #333;
}

/* CAROUSEL */
.carousel{
  position:relative;
  overflow:hidden;
  border-radius:16px;
  margin:18px 0;
  height:450px; 
}
.carousel-track{
  display:flex;
  height:100%;
  transition:transform .6s ease;
}
.carousel-slide{
  min-width:100%;
  background-size:cover; 
  background-position:center;
  background-repeat:no-repeat;
}
.carousel-dots{
  position:absolute;
  bottom:10px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:6px;
}
.carousel-dots span{
  width:10px;
  height:10px;
  border-radius:50%;
  background:rgba(255,255,255,.4);
}
.carousel-dots .active{background:white;}

.qrWrap{
  display:flex;
  gap:14px;
  align-items:center;
  margin-top:14px;
}
.qr{
  width:96px;
  height:96px;
  border-radius:14px;
  border:1px solid var(--border);
  background:var(--soft);
}
.small{font-size:12px;color:var(--muted);}

/* VIDEO CONTAINER */
.video-wrap {
  margin-top: 20px;
  border-radius: 14px;
  overflow: hidden;
  position: relative;
  padding-bottom: 56.25%;
  height: 0;
  background: #000;
}
.video-wrap iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
</style>
</head>

<body>
<div class="wrap">

<div class="tools">
  <button class="btn" id="toggleTheme">üåô</button>
  <button class="btn" id="toggleLang">FR / EN</button>
</div>

<div class="card hero">
  Show V√©lo 2026
</div>

<div class="card">
  <div class="pad">
    <div class="top">
      <div>
        <h1 id="title"></h1>
        <div class="sub">
          <span id="goalLbl"></span> : <span id="goalTxt"></span> ‚Ä¢
          <span id="minLbl"></span> : <span id="minTxt"></span> ‚Ä¢
          <span id="endLbl"></span> : <span id="endTxt"></span>
        </div>
      </div>
      <div class="amount" id="currentTxt">‚Äî</div>
    </div>

    <div class="bar"><div class="fill" id="fill"></div></div>

    <div class="row">
      <div><span id="updatedLbl"></span> : <strong id="updatedTxt"></strong></div>
      <div class="pill" id="daysLeft"></div>
    </div>

    <div class="grid">
      <div class="box">
        <div class="small" id="minMilestoneLbl"></div>
        <div id="minStatus"></div>
      </div>
      <div class="box">
        <div class="small" id="remainingLbl"></div>
        <div id="remainingTxt"></div>
      </div>
    </div>

    <button class="btn primary" id="btnIban"></button>

    <div class="qrWrap" id="qrWrap" style="display:none;">
      <img class="qr" id="qrImg">
      <div class="small">
        <strong>Payconiq</strong><br>
        Scan du QR code (montant libre)<br>
        <code>Show V√©lo 2026</code>
      </div>
    </div>

    <div class="small">
      <span id="ibanMsgLbl"></span><br>
      <code>Show V√©lo 2026</code>
    </div>

    <div class="small" id="statusTxt"></div>
  </div>
</div>

<div class="card pad">
  <h2 id="storyTitle"></h2>

  <div class="carousel">
    <div class="carousel-track" id="carouselTrack">
      <div class="carousel-slide" style="background-image:url('img/show1.jpg')"></div>
      <div class="carousel-slide" style="background-image:url('img/show2.jpg')"></div>
      <div class="carousel-slide" style="background-image:url('img/show3.jpg')"></div>
      <div class="carousel-slide" style="background-image:url('img/show4.jpg')"></div>
    </div>
    <div class="carousel-dots" id="carouselDots"></div>
  </div>

  <h3 id="presentationTitle"></h3>
  <p class="story" id="presentationTxt"></p>
  
  <h3 id="historyTitle"></h3>
  <p class="story" id="historyTxt"></p>

  <h3 id="figuresTitle"></h3>
  <p class="story" id="figuresTxt"></p>

  <h3 id="orgaTitle"></h3>
  <p class="story" id="orgaTxt"></p>

  <div id="ytWrap" class="video-wrap" style="display:none;">
    <iframe id="ytPlayer" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>
  
  <h3 id="fundingTitle"></h3>
  <p class="story" id="fundingTxt"></p>

  <h3 id="sponsorTitle"></h3>
  <p class="story" id="sponsorTxt"></p>
</div>

</div>

<script>
const DATA_URL="https://script.google.com/macros/s/AKfycbyx9hFIluBr_UTahmez68hl3PG-dcRByqaKyCB6xU-Y15EEVXONuPGXt_84MP3U6Ohd/exec";
const TOKEN="4444";

const LANGS={
fr:{
 title:'Soutenir "Show V√©lo 2026"',
 goal:"Objectif",min:"Minimum",end:"Date limite",
 updated:"Mis √† jour",
 minMilestone:"Seuil minimum",
 remaining:"Reste √† atteindre",
 iban:"Virement bancaire (copier IBAN)",
 ibanMsg:"Communication sugg√©r√©e",
 thanks:"üôè Merci pour votre soutien !",
 reached:"üéâ Objectif atteint !",
 day:"jour",
 days:"jours",
 lastDay:"üî• Dernier jour",
 story:{
  title:"Le projet",
  presentationTitle : "Pr√©sentation du projet",
  presentation: `Nous faisons appel √† votre g√©n√©rosit√© afin de soutenir la r√©alisation du Show-V√©lo, un spectacle d‚Äôacrobaties √† v√©lo pr√©par√© tout au long de l‚Äôann√©e par pr√®s de cinquante scouts √¢g√©s de 12 √† 18 ans. Ce spectacle rassemble synchronisation, technique et cr√©ativit√©.`,
  historyTitle: "Histoire du show-v√©lo",
  history: `V√©ritable moment phare de la vie de la Troupe, le Show-V√©lo est un √©v√©nement unique m√™lant agilit√©, force et cr√©ativit√©. Face √† un public de plus de 3 000 spectateurs, √† la lueur des flambeaux, les scouts ma√Ætrisent leur v√©lo pour r√©aliser des figures toujours plus impressionnantes.`,
  figuresTitle:"Exercices d‚Äôensemble et acrobaties",
  figures:`Le spectacle se compose de deux grands types de performances. Les exercices d‚Äôensemble reposent sur une synchronisation parfaite : alignement millim√©tr√©, timing rigoureux et concentration absolue permettent aux scouts de former des figures spectaculaires. Les acrobaties mettent l‚Äôaccent sur le risque et la difficult√© technique.`,
  orgaTitle:"Une organisation technique impressionnante",
  orga:`Le Show-V√©lo ne pourrait exister sans une organisation technique pointilleuse. Accompagnement musical, effets pyrotechniques, et 25 000 watts de jeux de lumi√®re contribuent √† faire de cet √©v√©nement un spectacle hors du commun. Cette ann√©e, nous souhaitons aller plus loin en faisant appel √† une √©quipe professionnelle pour assurer le tournage et la retransmission du spectacle en direct.`,
  fundingTitle:"√Ä quoi servira le financement ?",
  funding:`Le poste de d√©pense principal concerne la sonorisation et les jeux de lumi√®re. Un √©v√©nement de cette ampleur n√©cessite un important apport logistique et technique. √Ä cela s‚Äôajoutent d‚Äôautres frais indispensables tels que l‚Äôimpression des affiches, l‚Äôentretien et la r√©paration des v√©los.`,
  sponsorTitle:"Sponsoring pour les entreprises",
  sponsor:`Pour les entreprises souhaitant soutenir le projet tout en gagnant en visibilit√©, un syst√®me de sponsoring a √©t√© mis en place. En contribuant, votre entreprise pourra afficher son logo sur des affiches et l‚Äôins√©rer dans les carnets distribu√©s lors du spectacle.`
 }
},
en:{
  title:'Support "Show v√©lo 2026"',
  goal:"Goal",min:"Minimum",end:"Deadline",
  updated:"Updated",
  minMilestone:"Minimum milestone",
  remaining:"Remaining to goal",
  iban:"Bank transfer (copy IBAN)",
  ibanMsg:"Suggested message",
  thanks:"üôè Every contribution helps!",
  reached:"üéâ Goal reached!",
  day:"day",
  days:"days",
  lastDay:"üî• Last day",
  story:{
    title:"The project",
    presentationTitle : "Project presentation",
    presentation: `We are calling on your generosity to support the realization of the Show-V√©lo, a bicycle acrobatics show prepared throughout the year by nearly fifty scouts aged 12 to 18. This show combines synchronization, technique and creativity.`,
    historyTitle: "History of the Show-V√©lo",
    history: `Every three years, and since 1942, on the occasion of the Saint-Michel College celebration, the Fourth Ardents Troop of Saint-Michel transforms the school courtyard into a true performance space. A true highlight of the Troop‚Äôs life, the Show-V√©lo combines agility, strength and creativity.`,
    figuresTitle:"Group exercises and acrobatics",
    figures:`The show consists of two main types of performances. Group exercises rely on perfect synchronization: millimeter-precise alignment, rigorous timing and absolute concentration allow the scouts to form spectacular geometric figures. Acrobatics emphasize risk and technical difficulty.`,
    orgaTitle:"An impressive technical organization",
    orga:`The Show-V√©lo could not exist without meticulous technical organization. Musical accompaniment, pyrotechnic effects, and 25,000 watts of lighting effects help make this event extraordinary. This year, we want to go further by using a professional team to ensure the filming and live broadcast of the show.`,
    fundingTitle:"What will the funding be used for?",
    funding:`The main expense concerns sound systems and lighting. An event of this scale requires significant logistical and material resources. Other essential costs include printing posters and booklets, maintenance and repair of bicycles.`,
    sponsorTitle:"Sponsorship for companies",
    sponsor:`For companies wishing to support the project while gaining visibility, a sponsorship system has been put in place. By contributing, your company can display its logo on posters and include an ad in the event booklets.`
    }
  }
};

let lang=localStorage.lang||"fr";
let theme=localStorage.theme||"light";
document.documentElement.dataset.theme=theme;

const set=(id,v)=>document.getElementById(id).textContent=v;
const fmt=n=>new Intl.NumberFormat("fr-BE",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(n);

function applyLang(){
 const L=LANGS[lang];
 set("title",L.title);
 set("goalLbl",L.goal);
 set("minLbl",L.min);
 set("endLbl",L.end);
 set("updatedLbl",L.updated);
 set("minMilestoneLbl",L.minMilestone);
 set("remainingLbl",L.remaining);
 set("btnIban",L.iban);
 set("ibanMsgLbl",L.ibanMsg);
 const S=L.story;
 set("storyTitle",S.title);
 set("presentationTitle",S.presentationTitle);
 set("presentationTxt",S.presentation);
 set("historyTitle",S.historyTitle);
 set("historyTxt",S.history);
 set("figuresTitle",S.figuresTitle);
 set("figuresTxt",S.figures);
 set("orgaTitle",S.orgaTitle);
 set("orgaTxt",S.orga);
 set("fundingTitle",S.fundingTitle);
 set("fundingTxt",S.funding);
 set("sponsorTitle",S.sponsorTitle);
 set("sponsorTxt",S.sponsor);
}

async function loadData(){
  try{
    const r = await fetch(`${DATA_URL}?token=${TOKEN}`);
    if(!r.ok) throw new Error("Fetch failed");
    const d = await r.json();

    const pct = Math.min(100, Math.round(d.current / d.goal * 100));
    document.getElementById("fill").style.width = pct + "%";
    set("currentTxt", `${fmt(d.current)} (${pct}%)`);
    set("goalTxt", fmt(d.goal));
    set("minTxt", fmt(d.minimum));
    set("remainingTxt", fmt(Math.max(0, d.goal - d.current)));
    set("endTxt", d.endDate);
    set("updatedTxt", d.updated);
    set("minStatus", d.current >= d.minimum ? "‚úÖ Atteint" : fmt(d.minimum - d.current));

    if (!d.endDate) {
      document.getElementById("daysLeft").textContent = "‚Äî";
    } else {
      const days = Math.max(0, Math.ceil((new Date(d.endDate) - Date.now()) / 86400000));
      const daysEl = document.getElementById("daysLeft");
      daysEl.classList.remove("warning");
      if (days === 0) {
        daysEl.textContent = LANGS[lang].lastDay;
        daysEl.classList.add("warning");
      } else {
        const unit = days === 1 ? LANGS[lang].day : LANGS[lang].days;
        daysEl.textContent = `‚è≥ ${days} ${unit}`;
        if (days <= 3) daysEl.classList.add("warning");
      }
    }

    if (d.payconiqQr) {
      document.getElementById("qrImg").src = d.payconiqQr;
      document.getElementById("qrWrap").style.display = "flex";
    }

    /* ---- YOUTUBE VIDEO (Nettoyage renforc√©) ---- */
    if (d.youtubeUrl && d.youtubeUrl.trim() !== "") {
      const url = d.youtubeUrl.trim();
      let videoId = "";
      if (url.includes('v=')) {
        videoId = url.split('v=')[1].split('&')[0];
      } else if (url.includes('youtu.be/')) {
        videoId = url.split('youtu.be/')[1].split('?')[0];
      }
      
      if (videoId) {
        document.getElementById("ytPlayer").src = `https://www.youtube.com/embed/${videoId}`;
        document.getElementById("ytWrap").style.display = "block";
      }
    }

    const btn = document.getElementById("btnIban");
    btn.onclick = async () => {
      await navigator.clipboard.writeText(d.iban);
      btn.textContent = "IBAN copi√© ‚úÖ";
      btn.classList.add("success");
      setTimeout(() => {
        btn.classList.remove("success");
        applyLang();
      }, 1500);
    };

    set("statusTxt", d.current >= d.goal ? LANGS[lang].reached : LANGS[lang].thanks);

  } catch (err) {
    console.error(err);
    document.getElementById("statusTxt").textContent = "‚ö†Ô∏è Donn√©es temporairement indisponibles";
  }
}

const track=document.getElementById("carouselTrack");
const dots=document.getElementById("carouselDots");
[...track.children].forEach((_,i)=>{
  const d=document.createElement("span");
  if(i===0)d.classList.add("active");
  dots.appendChild(d);
});
let index=0;
setInterval(()=>{
  index=(index+1)%track.children.length;
  track.style.transform=`translateX(-${index*100}%)`;
  [...dots.children].forEach((d,i)=>d.classList.toggle("active",i===index));
},4000);

document.getElementById("toggleTheme").onclick=()=>{
  theme=theme==="light"?"dark":"light";
  document.documentElement.dataset.theme=theme;
  localStorage.theme=theme;
};
document.getElementById("toggleLang").onclick=()=>{
  lang=lang==="fr"?"en":"fr";
  localStorage.lang=lang;
  applyLang();
};

applyLang();
loadData();
</script>
</body>
</html>
