<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Fundraiser</title>

<style>
:root{
  --bg:#fff;--text:#111827;--muted:#6b7280;--border:#e5e7eb;
  --soft:#f3f4f6;--fill:#111827;--radius:18px;
  --success:#16a34a;
}
[data-theme="dark"]{
  --bg:#0f172a;--text:#f8fafc;--muted:#94a3b8;
  --border:#1e293b;--soft:#020617;--fill:#38bdf8;
}
body{
  margin:0;padding:18px;background:#fafafa;color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
}
[data-theme="dark"] body{background:#020617;}
.wrap{max-width:760px;margin:0 auto;}
.card{
  background:var(--bg);border:1px solid var(--border);
  border-radius:var(--radius);box-shadow:0 8px 26px rgba(0,0,0,.06);
  overflow:hidden;
}
.pad{padding:18px 20px;}
.top{display:flex;justify-content:space-between;gap:12px;}
h1{margin:0;font-size:20px;}
.sub{color:var(--muted);font-size:13px;margin-top:4px;}
.amount{font-weight:900;font-size:18px;white-space:nowrap;}
.bar{margin-top:14px;height:14px;background:var(--soft);
  border-radius:999px;overflow:hidden;}
.fill{height:100%;width:0%;background:var(--fill);
  transition:width .8s ease;}
.row{display:flex;justify-content:space-between;
  margin-top:10px;font-size:12px;color:var(--muted);}
.pill{border:1px solid var(--border);padding:3px 9px;
  border-radius:999px;background:#fff;}
.grid{display:grid;grid-template-columns:1fr 1fr;
  gap:10px;margin-top:14px;}
.box{border:1px solid var(--border);border-radius:14px;padding:12px;}
.label{font-size:12px;color:var(--muted);}
.value{margin-top:4px;font-weight:800;}
.cta{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap;}
.btn{
  padding:10px 12px;border-radius:12px;border:1px solid var(--border);
  background:#fff;font-weight:700;cursor:pointer;
}
.btn.primary{background:var(--fill);color:#fff;}
.btn.success{background:var(--success);color:#fff;}
.small{font-size:12px;color:var(--muted);}
.status{border-top:1px solid var(--border);
  padding:12px 20px;font-size:13px;}
.err{color:#b91c1c;font-size:13px;}
.tools{display:flex;gap:8px;margin-bottom:10px;}
.admin{background:#020617;color:#e5e7eb;
  padding:10px;border-radius:10px;margin-top:10px;font-size:12px;}
</style>
</head>

<body>
<div class="wrap">

  <div class="tools">
    <button class="btn" id="toggleTheme">ðŸŒ™</button>
    <button class="btn" id="toggleLang">FR / EN</button>
  </div>

  <div class="card">
    <div class="pad">
      <div class="top">
        <div>
          <h1 id="title">Support "Show vÃ©lo 2026"</h1>
          <div class="sub">
            <span id="goalLbl"></span>: <span id="goalTxt"></span> â€¢
            <span id="minLbl"></span>: <span id="minTxt"></span> â€¢
            <span id="endLbl"></span>: <span id="endTxt"></span>
          </div>
        </div>
        <div class="amount" id="raisedTxt">â€”</div>
      </div>

      <div class="bar"><div class="fill" id="fill"></div></div>

      <div class="row">
        <div><span id="updatedLbl"></span>: <strong id="updatedTxt"></strong></div>
        <div class="pill" id="daysLeft"></div>
      </div>

      <div class="grid">
        <div class="box">
          <div class="label" id="minMilestoneLbl"></div>
          <div class="value" id="minStatus"></div>
        </div>
        <div class="box">
          <div class="label" id="remainingLbl"></div>
          <div class="value" id="remainingTxt"></div>
        </div>
      </div>

      <div class="cta">
        <button class="btn primary" id="btnIban"></button>
      </div>

      <div class="small">
        <span id="ibanMsgLbl"></span><br>
        <code>PROJET â€“ Your Name</code>
      </div>

      <div class="err" id="error"></div>
      <div class="admin" id="adminBox" style="display:none;"></div>
    </div>

    <div class="status" id="statusTxt">Loadingâ€¦</div>
  </div>
</div>

<script>
const DATA_URL="https://script.google.com/macros/s/AKfycbzWl5VusAeMlm5Xthev0VDpY59EnbuoH2rFN9knSiseY85ARyW7fLMoF9KNs_1nJFsT/exec";
const TOKEN="4444";

const LANGS={
fr:{
title:"Soutenir "Show vÃ©lo 2026"",
goal:"Objectif",min:"Minimum",end:"Date limite",
updated:"Mis Ã  jour",minMilestone:"Seuil minimum",
remaining:"Reste Ã  atteindre",
iban:"Virement bancaire (copier IBAN)",
ibanMsg:"Communication suggÃ©rÃ©e",
thanks:"ðŸ™ Merci pour votre soutien !",
reached:"ðŸŽ‰ Objectif atteint !"
},
en:{
title:"Support "Show vÃ©lo 2026"",
goal:"Goal",min:"Minimum",end:"Deadline",
updated:"Updated",minMilestone:"Minimum milestone",
remaining:"Remaining to goal",
iban:"Bank transfer (copy IBAN)",
ibanMsg:"Suggested message",
thanks:"ðŸ™ Every contribution helps!",
reached:"ðŸŽ‰ Goal reached!"
}
};

let lang=localStorage.lang||"fr";
let theme=localStorage.theme||"light";
document.documentElement.dataset.theme=theme;

const set=(id,v)=>document.getElementById(id).textContent=v;

function applyLang(){
const L=LANGS[lang];
set("title",L.title);
set("goalLbl",L.goal);
set("minLbl",L.min);
set("endLbl",L.end);
set("updatedLbl",L.updated);
set("minMilestoneLbl",L.minMilestone);
set("remainingLbl",L.remaining);
set("btnIban",L.iban);
set("ibanMsgLbl",L.ibanMsg);
}

function animateValue(el,start,end,dur=800){
let t0=null;
function step(t){
if(!t0)t0=t;
const p=Math.min((t-t0)/dur,1);
el.textContent=Math.round(start+(end-start)*p).toLocaleString("fr-BE")+" â‚¬";
if(p<1)requestAnimationFrame(step);
}
requestAnimationFrame(step);
}

function loadData(){
fetch(`${DATA_URL}?token=${TOKEN}`)
.then(r=>r.json())
.then(d=>{
const pct=Math.min(100,Math.round(d.raised/d.goal*100));
document.getElementById("fill").style.width=pct+"%";
animateValue(document.getElementById("raisedTxt"),0,d.raised);
set("goalTxt",d.goal+" â‚¬");
set("minTxt",d.minimum+" â‚¬");
set("endTxt",d.endDate);
set("updatedTxt",d.updated);
set("remainingTxt",Math.max(0,d.goal-d.raised)+" â‚¬");
set("minStatus",d.raised>=d.minimum?"âœ… OK":"âŒ");
set("daysLeft","");

document.getElementById("btnIban").onclick=async()=>{
await navigator.clipboard.writeText(d.iban);
};

document.getElementById("statusTxt").textContent=
d.raised>=d.goal?LANGS[lang].reached:LANGS[lang].thanks;

if(location.search.includes("admin=1")){
const a=document.getElementById("adminBox");
a.style.display="block";
a.textContent=JSON.stringify(d,null,2);
}
});
}

document.getElementById("toggleTheme").onclick=()=>{
theme=theme==="light"?"dark":"light";
document.documentElement.dataset.theme=theme;
localStorage.theme=theme;
};

document.getElementById("toggleLang").onclick=()=>{
lang=lang==="fr"?"en":"fr";
localStorage.lang=lang;
applyLang();
};

applyLang();
loadData();
</script>
</body>
</html>
